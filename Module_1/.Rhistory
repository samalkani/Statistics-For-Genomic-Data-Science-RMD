BiocManager::install(c("S4Vectors"), type = "source", force = TRUE)
library(Biostrings)
library(Biostrings)
library(BiocVersion)
library(BiocParallel)
library(BiocManager)
library(BiocGenerics)
library(Biobase)
library(Biostrings)
BiocManager::install(c("Biostrings"), type = "source", force = TRUE)
library(limma)
library(S4Vectors)
library(survival, lib.loc = "C:/Program Files/R/R-4.5.2/library")
library(edgeR)
library(DBI)
library(BSgenome.Hsapiens.UCSC.hg19)
library(BSgenome.Scerevisiae.UCSC.sacCer2)
library(BiocIO)
library(edge)
BiocManager::install(c("edge"), force = TRUE)
library(edge)
BiocManager::install(c("annotate"), force = TRUE)
BiocManager::install(c("AnnotationDbi"), force = TRUE)
library(edge)
library(genefilter)
library(IRanges)
library(qvalue)
library(Rhtslib)
detach("package:S4Vectors", unload = TRUE)
library(sva)
library(sva)
library(XVector)
library(edge)
BiocManager::install(c("S4Vectors"), type = "source", force = TRUE)
remove.packages("S4Vectors")
BiocManager::install(c("S4Vectors"), type = "source", force = TRUE)
# 2. Installing genefilter
BiocManager::install(c("genefilter"), type = "source", force = TRUE)
# 1. Installing Bioconductor package
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install()
# 2. Installing genefilter
# BiocManager::install(c("genefilter"), type = "source", force = TRUE)
# 3. Troubleshooting installing packages
# BiocManager::valid()
# 4. Load Libraries
library(devtools)
library(Biobase)
library(limma)
library(edge)
library(genefilter)
# 5. Plotting Parameters
tropical = c("darkorange", "dodgerblue", "hotpink", "limegreen", "yellow")
palette(tropical)
par(pch=19)
# 6. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
bot = bottomly.eset
bot
pdata=pData(bot)
head(pdata)
edata=as.matrix(exprs(bot))
head(edata)
fdata = fData(bot)
head(fdata)
ls()
# 7. Log2 Transformation of data
edata = log2(as.matrix(edata) + 1)
# 8. Remove lowly expressed gene data (gene counts below 10)
edata = edata[rowMeans(edata) > 10, ]
# 9. Performing row t-tests to compare between groups (different strains)
tstats_obj = rowttests(edata,pdata$strain)
names(tstats_obj)
# 10. Histogram of T-statistic for every gene in the edata for the two strains
hist(tstats_obj$statistic,col=2)
# 11. Display the levels of the lanes variable
table(pdata$lane.number)
# 12. Performing row F-tests to compare between multiple groups (e.g lane.number)
fstats_obj = rowFtests(edata,as.factor(pdata$lane.number))
names(fstats_obj)
# 13. F-statistic for the lane.number variable for all genes in edata
hist(fstats_obj$statistic,col=2)
# 14. Fit a non-adjusted model of the strain variable using the limma package
# which gives moderated results (T-statistic is not inflated by small variance)
mod = model.matrix(~ pdata$strain)
fit_limma = lmFit(edata,mod)
ebayes_limma = eBayes(fit_limma)
# 15. Display Test statistics for the intercept and the strain variable
head(ebayes_limma$t)
# 16. Plot of moderated t-statistic from the limma package vs t-statistic (unmoderated)
plot(ebayes_limma$t[,2],-tstats_obj$statistic,col=4,
xlab="Moderated T-stat",ylab="T-stat")
abline(c(0,1),col="darkgrey",lwd=3)
# 17. Use the Limma package to give an adjusted model and adjusted t-statistic
# This cannot be done with the Genefilter package
mod_adj = model.matrix(~ pdata$strain + as.factor(pdata$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
head(ebayes_limma_adj$t)
# 18. Plot adjusted, moderated t-stat from Limma package vs unadjusted, unmoderated t-stat
plot(ebayes_limma_adj$t[,2],-tstats_obj$statistic,col=3,
xlab="Moderated, Adjusted T-stat",ylab="T-stat")
abline(c(0,1),lwd=3,col="darkgrey")
# 19. Using Limma package for multiple level variable lane.number
mod_lane = model.matrix(~ as.factor(pdata$lane.number))
fit_limma_lane = lmFit(edata,mod_lane)
ebayes_limma_lane = eBayes(fit_limma_lane)
head(ebayes_limma_lane$t)
# 20. Find the most significant level in the lane variable for each gene
top_lane = topTable(ebayes_limma_lane, coef=2:7,
+                     number=dim(edata)[1],sort.by="none")
# 20. Find the most significant level in the lane variable for each gene
top_lane = topTable(ebayes_limma_lane, coef=2:7,number=dim(edata)[1],sort.by="none")
head(top_lane)
# 21. Plot of the moderated version of the F-statistic we saw earlier
# Remember F-statistic is for multiple level variables
plot(top_lane$F,fstats_obj$statistic,
xlab="Moderated F-statistic",ylab="F-statistic",col=3)
# 22. Using the Edge package for multi-level lane variable
edge_study = build_study(edata, grp = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
qval = qvalueObj(de_obj)
names(qval)
# 23. Plot of comparison of F-statistic from the gene filter and the edge packages
plot(qval$stat,fstats_obj$statistic,col=4,
xlab="F-stat from edge",ylab="F-stat from genefilter")
# 24. Use the Edge package to construct a new model with adjustment
edge_study2 = build_study(edata, grp = as.factor(pdata$lane.number),
adj.var=pdata$strain)
de_obj2 = lrt(edge_study2)
qval2 = qvalueObj(de_obj2)
plot(qval2$stat,fstats_obj$statistic,col=4,
xlab="F-stat from edge",ylab="F-stat from genefilter")
# 24. Use the Edge package to construct a new model with adjustment
edge_study2 = build_study(edata, grp = as.factor(pdata$lane.number),
adj.var=pdata$strain)
de_obj2 = lrt(edge_study2)
qval2 = qvalueObj(de_obj2)
plot(qval2$stat,fstats_obj$statistic,col=4,
xlab="F-stat from edge",ylab="F-stat from genefilter")
# 18. Plot adjusted, moderated t-stat from Limma package vs unadjusted, unmoderated t-stat
plot(ebayes_limma_adj$t[,2],-tstats_obj$statistic,col=3,
xlab="Moderated, Adjusted T-stat",ylab="T-stat")
abline(c(0,1),lwd=3,col="darkgrey")
remove.packages("qvalue")
# 2. Installing qvalue
BiocManager::install(c("qvalue"), type = "source", force = TRUE)
# 4. Load Libraries
library(devtools)
library(Biobase)
library(limma)
library(edge)
library(genefilter)
library(qvalue)
# 5. Plotting Parameters
tropical = c("darkorange", "dodgerblue", "hotpink", "limegreen", "yellow")
palette(tropical)
par(pch=19)
# 6. Load the Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
bot = bottomly.eset
bot
pdata=pData(bot)
head(pdata)
edata=as.matrix(exprs(bot))
head(edata)
fdata = fData(bot)
head(fdata)
ls()
# 7. Log2 transform and removing lowly expressed genes
edata = log2(as.matrix(edata) + 1)
edata = edata[rowMeans(edata) > 10, ]
# 8. Calculating the F-statistic and p-values using the gene filter package
fstats_obj = rowFtests(edata,as.factor(pdata$strain))
hist(fstats_obj$p.value,col=2)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain,
adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
detach("package:qvalue", unload = TRUE)
remove.packages("qvalue")
detach("package:Biobase", unload = TRUE)
detach("package:BiocGenerics", unload = TRUE)
detach("package:Biobase", unload = TRUE)
detach("package:Biobase", unload = TRUE)
detach("package:edge", unload = TRUE)
detach("package:devtools", unload = TRUE)
detach("package:Biobase", unload = TRUE)
detach("package:BiocGenerics", unload = TRUE)
detach("package:generics", unload = TRUE)
detach("package:genefilter", unload = TRUE)
detach("package:limma", unload = TRUE)
# 2. Installing qvalue
BiocManager::install(c("qvalue"), type = "source", force = TRUE)
# 2. Installing qvalue
BiocManager::install(c('digest', 'Rhtslib', 'xml2'), type = "source", force = TRUE)
# 4. Load Libraries
library(devtools)
library(Biobase)
library(limma)
library(edge)
library(genefilter)
library(qvalue)
# 5. Plotting Parameters
tropical = c("darkorange", "dodgerblue", "hotpink", "limegreen", "yellow")
palette(tropical)
par(pch=19)
# 6. Load the Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
bot = bottomly.eset
bot
pdata=pData(bot)
head(pdata)
edata=as.matrix(exprs(bot))
head(edata)
fdata = fData(bot)
head(fdata)
ls()
# 7. Log2 transform and removing lowly expressed genes
edata = log2(as.matrix(edata) + 1)
edata = edata[rowMeans(edata) > 10, ]
# 8. Calculating the F-statistic and p-values using the gene filter package
fstats_obj = rowFtests(edata,as.factor(pdata$strain))
hist(fstats_obj$p.value,col=2)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain,
adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain, adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 9. Construct an adjusted model using the edge package, Strain (variable of interest),
# Lane (adjustment variable), model is not moderated (may get inflated statistics)
edge_study = build_study(edata, grp = pdata$strain, adj.var = as.factor(pdata$lane.number))
de_obj = lrt(edge_study)
# 4. Load Libraries
library(goseq)
# 5. Display data
head(supportedGenomes())
detach("package:geneLenDataBase", unload = TRUE)
detach("package:geneLenDataBase", unload = TRUE)
detach("package:goseq", unload = TRUE)
detach("package:geneLenDataBase", unload = TRUE)
# 1. Installing Bioconductor package
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install()
# 2. Installing qvalue
# BiocManager::install("goseq")
# 3. Troubleshooting installing packages
# BiocManager::valid()
# 4. Load Libraries
library(goseq)
# 5. Display data
head(supportedGenomes())
# 6. Display data – Available cases
head(supportedGeneIDs())
# 7. Load data from goseq package
temp_data =read.table(system.file("extdata","Li_sum.txt",
package="goseq"),sep="\t",
header=TRUE,
stringsAsFactors=FALSE)
# 8. First row of the data set
temp_data[1,]
# 9. Remove 1st column of data set and replace it with rownames = gene names
expr= temp_data[,-1]
rownames(expr) = temp_data[,1]
# 10. Remove lowly expressed genes
expr = expr[rowMeans(expr) > 5,]
# 11. Create a group variable, the data doesn't have a group variable
grp=factor(rep(c("Control","Treated"),times=c(4,3)))
grp
# 12. Create a pdata (phenotype) object with just the grp variable in it
pdata  = data.frame(grp)
pdata[1,]
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
library(DESeq2)
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
# 14. Use DESeq to identify differentially expressed genes
de_fit = DESeq(de)
# 15. Calculate the results using the results function
de_results = results(de_fit)
# 16. Display differentially expressed results
head(de_fit)
# 17. Remove the genes where we can’t calculate a statistic
# 17. A. Filter genes that are differentially expressed < 0.05 (FDR)
genes = as.integer(de_results$padj < 0.05)
# 17. B. Remove data were there wasn't enough data
not_na = !is.na(genes)
# 17. C. Apply row names to match genes to genomic data
names(genes) = rownames(expr)
# 17. D. Remove genes we can't calculate a statistic for
genes = genes[not_na]
# 18. We need to set up a weighting function for all the genes in that genome
pwf=nullp(genes,"hg19","ensGene")
# 19. Use goseq package to calculate the statistics for enrichment
GO.wall=goseq(pwf,"hg19","ensGene")
# 20. Display results
head(GO.wall)
# 21. Selecting a specific category of interest for your analysis
GO.MF=goseq(pwf,"hg19","ensGene",test.cats=c("GO:MF"))
head(GO.MF)
# 8. First row of the data set
temp_data[1,]
# 7. Load data from goseq package
temp_data =read.table(system.file("extdata","Li_sum.txt",
package="goseq"),sep="\t",
header=TRUE,
stringsAsFactors=FALSE)
# 8. First row of the data set
temp_data[1,]
# 9. Remove 1st column of data set and replace it with rownames = gene names
expr= temp_data[,-1]
expr
rownames(expr) = temp_data[,1]
temp_data[,1]
# 10. Remove lowly expressed genes
expr = expr[rowMeans(expr) > 5,]
# 11. Create a group variable, the data doesn't have a group variable
grp=factor(rep(c("Control","Treated"),times=c(4,3)))
grp
# 12. Create a pdata (phenotype) object with just the grp variable in it
pdata  = data.frame(grp)
pdata[1,]
head(pdata)
head(expr)
# 13. Passing expression(expr), phenotype data(pdata) and the grp variable you want to model
library(DESeq2)
de = DESeqDataSetFromMatrix(expr, pdata, ~grp)
head(de)
# 16. Display differentially expressed results
head(de_results)
# 16. Display differentially expressed results
head(de_results)
setwd("D:/Ajay Files/Genomic Data Science Courses/Genomic Data Science/Course 6 - Statistics for Genomic Data Science/Module_1")
setwd("D:/Ajay Files/Genomic Data Science Courses/Genomic Data Science/Course 6 - Statistics for Genomic Data Science/Module_3")
setwd("D:/Ajay Files/Genomic Data Science Courses/Genomic Data Science/Course 6 - Statistics for Genomic Data Science/Module_4")
setwd("D:/Ajay Files/Genomic Data Science Courses/Genomic Data Science/Course 6 - Statistics for Genomic Data Science/Module_1")
