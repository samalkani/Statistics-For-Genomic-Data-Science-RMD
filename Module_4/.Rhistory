genes = as.integer(limma_table$adj.P.Val < 0.05)
names(genes) = rownames(edata)
not_na = !is.na(genes)
genes = genes[not_na]
# 3. C. Use nullp and goseq to perform a gene ontology analysis
pwf = nullp(genes, "mm9", "ensGene")
# 3. D. Gene Annotation
library(org.Mm.eg.db)
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10 = GO.wall[1:10,1]
# 3. E. Top category
GO.top10[1]
# 4. A. Top term
GO.wall$term[1]
# Question 5
# Load the Bottomly data with the following code and perform a differential expression
# analysis using limma and treating strain as the outcome but adjusting for lane as a
# factor. Then find genes significant at the 5% FDR rate using the Benjamini Hochberg
# correction and perform the gene set analysis with goseq following the protocol from
# the first 4 questions. How many of the top 10 overrepresented categories are the same
# for the adjusted and unadjusted analysis?
# 5. A. Load Libraries
library(Biobase)
library(limma)
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
head(fdata_bot)
edata = exprs(bot)
edata = exprs(bot)
head(edata)
# 5. C. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. D. Find genes significant at 5% FPR rate
limma_table = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes = as.integer(limma_table$adj.P.Val < 0.05)
names(genes) = rownames(edata)
not_na = !is.na(genes)
genes = genes[not_na]
pwf = nullp(genes, "mm9", "ensGene")
# 5. E. Annotation
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10_adj = GO.wall[1:10,1]
# 5. E. Top 10 overrepresented categories are the same
intersect(GO.top10, GO.top10_adj)
# 5. C. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. D. Find genes significant at 5% FPR rate
limma_table = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes = as.integer(limma_table$adj.P.Val < 0.05)
names(genes) = rownames(edata)
not_na = !is.na(genes)
genes = genes[not_na]
pwf = nullp(genes, "mm9", "ensGene")
# 5. E. Annotation
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10_adj = GO.wall[1:10,1]
# 5. E. Top 10 overrepresented categories are the same
intersect(GO.top10, GO.top10_adj)
# 5. C. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 2. D. Perform a differential expression analysis using limma
mod = model.matrix(~ pdata_bot$strain)
fit_limma = lmFit(edata, mod)
ebayes_limma = eBayes(fit_limma)
limma_pvals = topTable(ebayes_limma,number=dim(edata)[1], adjust.method ="BH", p.value=0.05, sort.by='none')
# 1. A. Installing Bioconductor package
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install()
# 1. B. Installing
# BiocManager::install(c("goseq"), force = TRUE)
# 1. C. Troubleshooting installing packages
# BiocManager::valid()
# 1. D. Load Libraries
library(goseq)
# 1. E. Identify the Mouse Genome the reads are align to
supportedGenomes()
# o	UCSC mm9
# o	UCSC hg18
# o	NCBI Build 35
# o	UCSC hg19
# Question 2
# Load the Bottomly data with the following code and perform a differential
# expression analysis using limma with only the strain variable as an outcome.
# How many genes are differentially expressed at the 5% FDR level using
# Benjamini-Hochberg correction? What is the gene identifier of the first gene
# differentially expressed at this level (just in order, not the smallest FDR)?
# (hint: the featureNames function may be useful)
# 2. A. Load Libraries
library(Biobase)
library(limma)
# 2. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
# 2. C. Remove lowly expressed genes and Log2 transform the data
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
edata = log2(edata+1)
head(edata)
# 2. D. Perform a differential expression analysis using limma
mod = model.matrix(~ pdata_bot$strain)
fit_limma = lmFit(edata, mod)
ebayes_limma = eBayes(fit_limma)
limma_pvals = topTable(ebayes_limma,number=dim(edata)[1], adjust.method ="BH", p.value=0.05, sort.by='none')
# 2. E. First DE gene
limma_pvals[1,]
# 2. F. Number of genes are differentially expressed at the 5% FPR level
dim(limma_pvals)
# o	9431 at FDR 5%; ENSMUSG00000027855 first DE gene
# o	223 at FDR 5%; ENSMUSG00000000402 first DE gene
# o	223 at FDR 5%; ENSMUSG00000027855 first DE gene
# o	90 at FDR 5%; ENSMUSG00000000001 first DE gene
# Question 3
# Use the nullp and goseq functions in the goseq package to perform a gene ontology
# analysis. What is the top category that comes up as over represented? (hint: you
# will need to use the genome information on the genome from question 1 and the
# differential expression analysis from question 2)
# 3. A. Load Libraries
library(devtools)
library(Biobase)
library(goseq)
library(DESeq2)
# 3. B. Limma fit with p-value less than 0.05
limma_table = topTable(ebayes_limma,number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes = as.integer(limma_table$adj.P.Val < 0.05)
names(genes) = rownames(edata)
not_na = !is.na(genes)
genes = genes[not_na]
# 3. C. Use nullp and goseq to perform a gene ontology analysis
pwf = nullp(genes, "mm9", "ensGene")
# 3. D. Gene Annotation
library(org.Mm.eg.db)
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10 = GO.wall[1:10,1]
# 3. E. Top category
GO.top10[1]
# o	GO:0043231
# o	GO:0004888
# o	GO:0038023
# o	GO:0001653
# Question 4
# Look up the GO category that was the top category from the previous question.
# What is the name of the category?
# 4. A. Top term
GO.wall$term[1]
# o	G-protein coupled peptide receptor activity
# o	peptide receptor activity
# o	signaling receptor activity
# o	transmembrane signaling receptor activity
# Question 5
# Load the Bottomly data with the following code and perform a differential expression
# analysis using limma and treating strain as the outcome but adjusting for lane as a
# factor. Then find genes significant at the 5% FDR rate using the Benjamini Hochberg
# correction and perform the gene set analysis with goseq following the protocol from
# the first 4 questions. How many of the top 10 overrepresented categories are the same
# for the adjusted and unadjusted analysis?
# 5. A. Load Libraries
library(Biobase)
library(limma)
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
# 5. C. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. D. Find genes significant at 5% FPR rate
limma_table = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes = as.integer(limma_table$adj.P.Val < 0.05)
names(genes) = rownames(edata)
not_na = !is.na(genes)
genes = genes[not_na]
pwf = nullp(genes, "mm9", "ensGene")
# 5. E. Annotation
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10_adj = GO.wall[1:10,1]
# 5. E. Top 10 overrepresented categories are the same
intersect(GO.top10, GO.top10_adj)
GO.top10_adj
GO.wall
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.wall
GO.wall = goseq(pwf, "mm9", "ensGene")
head(GO.wall)
GO.top10_adj = GO.wall[1:10,1]
GO.top10_adj
intersect(GO.wall, GO.top10_adj)
intersect(GO.top10, GO.top10_adj)
head(GO.wall)
GO.top10_adj
limma_table
head(limma_table)
# 5. D. Find genes significant at 5% FPR rate
limma_table = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table$adj.P.Val < 0.05)
genes = as.integer(limma_table$P.Value < 0.05)
names(genes_adj) = rownames(edata)
names(genes) = rownames(edata)
not_na = !is.na(genes_adj)
not_na = !is.na(genes)
genes_adj = genes_adj[not_na]
genes = genes[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
pwf = nullp(genes, "mm9", "ensGene")
# 5. E. Annotation
GO.wall_adj = goseq(pwf_adj, "mm9", "ensGene")
GO.wall = goseq(pwf, "mm9", "ensGene")
GO.top10_adj = GO.wall[1:10,1]
GO.top10 = GO.wall[1:10,1]
# 5. F. Top 10 overrepresented categories are the same
intersect(GO.top10, GO.top10_adj)
GO.top10_adj = GO.wall[1:10,1]
GO.top10_adj
GO.top10 = GO.wall[1:10,1]
GO.top10
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod)
ebayes_limma_unadj = eBayes(fit_limma)
# 5. D. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. G. Annotation
GO.wall_adj = goseq(pwf_adj, "mm9", "ensGene")
GO.top10_adj = GO.wall_adj[1:10,1]
GO.wall_unadj = goseq(pwf_unadj, "mm9", "ensGene")
GO.top10_unadj = GO.wall_unadj[1:10,1]
# 5. H. Top 10 overrepresented categories are the same
intersect(GO.top10_unadj, GO.top10_adj)
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod)
ebayes_limma_unadj = eBayes(fit_limma)
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. G. Annotation
GO.wall_adj = goseq(pwf_adj, "mm9", "ensGene")
GO.top10_adj = GO.wall_adj[1:10,1]
GO.wall_unadj = goseq(pwf_unadj, "mm9", "ensGene")
GO.top10_unadj = GO.wall_unadj[1:10,1]
# 5. H. Top 10 overrepresented categories are the same
intersect(GO.top10_unadj, GO.top10_adj)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod)
ebayes_limma_unadj = eBayes(fit_limma)
# 5. D. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod_unadj)
ebayes_limma_unadj = eBayes(fit_limma_unadj)
# 5. D. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. G. Annotation
GO.wall_adj = goseq(pwf_adj, "mm9", "ensGene")
GO.top10_adj = GO.wall_adj[1:10,1]
GO.wall_unadj = goseq(pwf_unadj, "mm9", "ensGene")
GO.top10_unadj = GO.wall_unadj[1:10,1]
# 5. H. Top 10 overrepresented categories are the same
intersect(GO.top10_unadj, GO.top10_adj)
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod_unadj)
ebayes_limma_unadj = eBayes(fit_limma_unadj)
# 5. D. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. A. Load Libraries
library(Biobase)
library(limma)
# 5. B. Load Data
con =url("http://bowtie-bio.sourceforge.net/recount/ExpressionSets/bottomly_eset.RData")
load(file=con)
close(con)
ls()
bot = bottomly.eset
bot
pdata_bot=pData(bot)
head(pdata_bot)
fdata_bot = featureData(bot)
head(fdata_bot)
edata = exprs(bot)
head(edata)
fdata_bot = fdata_bot[rowMeans(edata) > 5]
head(fdata_bot)
edata = edata[rowMeans(edata) > 5, ]
head(edata)
# 5. C. Perform a differential expression analysis using limma, unadjusted for lane
mod_unadj = model.matrix(~ pdata_bot$strain)
fit_limma_unadj = lmFit(edata,mod_unadj)
ebayes_limma_unadj = eBayes(fit_limma_unadj)
# 5. D. Perform a differential expression analysis using limma, adjusting for lane as a factor
mod_adj = model.matrix(~ pdata_bot$strain + as.factor(pdata_bot$lane.number))
fit_limma_adj = lmFit(edata,mod_adj)
ebayes_limma_adj = eBayes(fit_limma_adj)
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. G. Annotation
GO.wall_adj = goseq(pwf_adj, "mm9", "ensGene")
GO.top10_adj = GO.wall_adj[1:10,1]
GO.wall_unadj = goseq(pwf_unadj, "mm9", "ensGene")
GO.top10_unadj = GO.wall_unadj[1:10,1]
# 5. H. Top 10 overrepresented categories are the same
intersect(GO.top10_unadj, GO.top10_adj)
GO.wall_results = cbind(GO.wall_unadj, GO.top10_adj)
GO.wall_results = cbind(GO.top10_unadj, GO.top10_adj)
GO.wall_results
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
# 5. E. Find genes significant at 5% FPR rate (unadjusted model)
limma_table_unadj = topTable(ebayes_limma_unadj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_unadj = as.integer(limma_table_unadj$adj.P.Val < 0.05)
names(genes_unadj) = rownames(edata)
not_na = !is.na(genes_unadj)
genes_unadj = genes_unadj[not_na]
pwf_unadj = nullp(genes_unadj, "mm9", "ensGene")
# 5. F. Find genes significant at 5% FPR rate (adjusted model)
limma_table_adj = topTable(ebayes_limma_adj, number=dim(edata)[1], adjust.method ="BH", sort.by='none')
genes_adj = as.integer(limma_table_adj$adj.P.Val < 0.05)
names(genes_adj) = rownames(edata)
not_na = !is.na(genes_adj)
genes_adj = genes_adj[not_na]
pwf_adj = nullp(genes_adj, "mm9", "ensGene")
